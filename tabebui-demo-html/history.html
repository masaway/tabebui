<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â±•Ê≠¥ - „Åü„Åπ„Å∂„ÅÑ</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- „Éò„ÉÉ„ÉÄ„Éº -->
    <header class="header">
        <div class="header-content">
            <a href="index.html" class="logo">ü•© „Åü„Åπ„Å∂„ÅÑ</a>
            <div class="user-info">
                <div class="level-badge" id="userLevel">Lv.1</div>
                <span id="userName">ËÇâÂ•Ω„Åç„É¶„Éº„Ç∂„Éº</span>
            </div>
        </div>
    </header>

    <!-- „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
    <nav class="nav">
        <a href="index.html" class="nav-link">„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</a>
        <a href="parts.html" class="nav-link">ÈÉ®‰Ωç„ÇíÈÅ∏„Å∂</a>
        <a href="progress.html" class="nav-link">ÈÄ≤ÊçóË©≥Á¥∞</a>
        <a href="history.html" class="nav-link active">Â±•Ê≠¥</a>
    </nav>

    <div class="container">
        <!-- „Éï„Ç£„É´„Çø„Éº„ÉªÊ§úÁ¥¢ -->
        <div class="card">
            <h2>üîç Â±•Ê≠¥Ê§úÁ¥¢„Éª„Éï„Ç£„É´„Çø„Éº</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                <div>
                    <label class="form-label">ÂãïÁâ©„ÅßÁµû„ÇäËæº„Åø</label>
                    <select id="animalFilter" class="form-control">
                        <option value="">ÂÖ®„Å¶„ÅÆÂãïÁâ©</option>
                        <option value="beef">üêÑ Áâõ</option>
                        <option value="pork">üê∑ Ë±ö</option>
                        <option value="chicken">üêî È≥•</option>
                    </select>
                </div>
                <div>
                    <label class="form-label">ÊúüÈñì</label>
                    <select id="periodFilter" class="form-control">
                        <option value="">ÂÖ®ÊúüÈñì</option>
                        <option value="today">‰ªäÊó•</option>
                        <option value="week">‰ªäÈÄ±</option>
                        <option value="month">‰ªäÊúà</option>
                        <option value="year">‰ªäÂπ¥</option>
                    </select>
                </div>
                <div>
                    <label class="form-label">Ê∫ÄË∂≥Â∫¶</label>
                    <select id="ratingFilter" class="form-control">
                        <option value="">ÂÖ®„Å¶„ÅÆË©ï‰æ°</option>
                        <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
                        <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê ‰ª•‰∏ä</option>
                        <option value="3">‚≠ê‚≠ê‚≠ê ‰ª•‰∏ä</option>
                    </select>
                </div>
                <div>
                    <label class="form-label">‰∏¶„Å≥È†Ü</label>
                    <select id="sortOrder" class="form-control">
                        <option value="date_desc">Êó•‰ªò(Êñ∞„Åó„ÅÑÈ†Ü)</option>
                        <option value="date_asc">Êó•‰ªò(Âè§„ÅÑÈ†Ü)</option>
                        <option value="rating_desc">Ê∫ÄË∂≥Â∫¶(È´ò„ÅÑÈ†Ü)</option>
                        <option value="rating_asc">Ê∫ÄË∂≥Â∫¶(‰Ωé„ÅÑÈ†Ü)</option>
                    </select>
                </div>
            </div>
            <div>
                <label class="form-label">„Ç≠„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢</label>
                <input type="text" id="searchKeyword" class="form-control" placeholder="ÈÉ®‰ΩçÂêç„ÄÅ„É°„É¢„ÄÅ„ÅäÂ∫óÂêç„ÅßÊ§úÁ¥¢...">
            </div>
        </div>

        <!-- Â±•Ê≠¥„Çµ„Éû„É™„Éº -->
        <div class="card">
            <h2>üìä Â±•Ê≠¥„Çµ„Éû„É™„Éº</h2>
            <div id="historySummary" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                <!-- ÂãïÁöÑ„Å´ÁîüÊàê -->
            </div>
        </div>

        <!-- Â±•Ê≠¥‰∏ÄË¶ß -->
        <div class="card">
            <h2>üìö È£ü‰∫ãÂ±•Ê≠¥</h2>
            <div id="recordsList">
                <!-- ÂãïÁöÑ„Å´ÁîüÊàê -->
            </div>
            <div id="noRecords" style="text-align: center; padding: 40px; color: #666; display: none;">
                <div style="font-size: 2em; margin-bottom: 15px;">üìù</div>
                <p>Ë®òÈå≤„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ</p>
                <a href="parts.html" class="btn btn-primary" style="margin-top: 15px;">ÈÉ®‰Ωç„ÇíË®òÈå≤„Åô„Çã</a>
            </div>
        </div>
    </div>

    <!-- Ë®òÈå≤Ë©≥Á¥∞„É¢„Éº„ÉÄ„É´ -->
    <div class="modal" id="recordDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Ë®òÈå≤Ë©≥Á¥∞</h3>
                <button class="close-btn" onclick="closeRecordDetailModal()">&times;</button>
            </div>
            <div id="recordDetailBody">
                <!-- ÂãïÁöÑ„Å´ÁîüÊàê -->
            </div>
        </div>
    </div>

    <!-- Ë®òÈå≤Á∑®ÈõÜ„É¢„Éº„ÉÄ„É´ -->
    <div class="modal" id="editRecordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Ë®òÈå≤Á∑®ÈõÜ</h3>
                <button class="close-btn" onclick="closeEditRecordModal()">&times;</button>
            </div>
            <div id="editModalBody">
                <form id="editRecordForm">
                    <div class="form-group">
                        <label class="form-label">ÈÉ®‰Ωç</label>
                        <div id="editPartInfo" style="padding: 15px; background: #f8f9fa; border-radius: 8px; margin-bottom: 10px;">
                            <!-- ÈÉ®‰ΩçÊÉÖÂ†± -->
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="editEatenDate">È£ü„Åπ„ÅüÊó•</label>
                        <input type="date" id="editEatenDate" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="editMemo">„É°„É¢„ÉªÊÑüÊÉ≥</label>
                        <textarea id="editMemo" class="form-control" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Ê∫ÄË∂≥Â∫¶</label>
                        <div id="editRatingStars" style="text-align: center; padding: 10px;">
                            <span class="star" data-rating="1">‚≠ê</span>
                            <span class="star" data-rating="2">‚≠ê</span>
                            <span class="star" data-rating="3">‚≠ê</span>
                            <span class="star" data-rating="4">‚≠ê</span>
                            <span class="star" data-rating="5">‚≠ê</span>
                        </div>
                        <input type="hidden" id="editRatingValue" value="5">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="editRestaurant">„ÅäÂ∫ó</label>
                        <input type="text" id="editRestaurant" class="form-control">
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 25px;">
                        <button type="submit" class="btn btn-success" style="flex: 1;">Êõ¥Êñ∞</button>
                        <button type="button" class="btn" onclick="deleteCurrentRecord()" style="background: #e74c3c; color: white;">ÂâäÈô§</button>
                        <button type="button" class="btn btn-outline" onclick="closeEditRecordModal()">„Ç≠„É£„É≥„Çª„É´</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="js/parts.js"></script>
    <script src="js/records.js"></script>
    <script src="js/main.js"></script>
    <script>
        let filteredRecords = [];
        let currentEditingRecordId = null;

        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„ÅÆÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            initializeHistoryPage();
            setupEventListeners();
        });

        // Â±•Ê≠¥„Éö„Éº„Ç∏ÂàùÊúüÂåñ
        function initializeHistoryPage() {
            const userLevel = getUserLevel();
            document.getElementById('userLevel').textContent = `Lv.${userLevel}`;
            
            updateHistorySummary();
            filterAndDisplayRecords();
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆö
        function setupEventListeners() {
            // „Éï„Ç£„É´„Çø„ÉºÂ§âÊõ¥
            ['animalFilter', 'periodFilter', 'ratingFilter', 'sortOrder'].forEach(id => {
                document.getElementById(id).addEventListener('change', filterAndDisplayRecords);
            });
            
            // Ê§úÁ¥¢„Ç≠„Éº„ÉØ„Éº„Éâ
            document.getElementById('searchKeyword').addEventListener('input', debounce(filterAndDisplayRecords, 300));
            
            // Á∑®ÈõÜ„Éï„Ç©„Éº„É†
            document.getElementById('editRecordForm').addEventListener('submit', handleEditSubmit);
            
            // Á∑®ÈõÜÁî®ÊòüË©ï‰æ°
            setupEditRatingStars();
        }

        // Â±•Ê≠¥„Çµ„Éû„É™„ÉºÊõ¥Êñ∞
        function updateHistorySummary() {
            const records = getRecords();
            const thisMonthRecords = getThisMonthRecords();
            const avgRating = records.length > 0 ? 
                records.reduce((sum, r) => sum + r.rating, 0) / records.length : 0;
            
            const uniqueParts = new Set(records.map(r => r.partId)).size;
            const uniqueRestaurants = new Set(
                records.filter(r => r.restaurant).map(r => r.restaurant)
            ).size;

            document.getElementById('historySummary').innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${formatNumber(records.length)}</div>
                    <div class="stat-label">Á∑èË®òÈå≤Êï∞</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${formatNumber(thisMonthRecords.length)}</div>
                    <div class="stat-label">‰ªäÊúà„ÅÆË®òÈå≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${formatNumber(uniqueParts)}</div>
                    <div class="stat-label">Ë®òÈå≤„Åó„ÅüÈÉ®‰ΩçÊï∞</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${avgRating.toFixed(1)}</div>
                    <div class="stat-label">Âπ≥ÂùáÊ∫ÄË∂≥Â∫¶</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${formatNumber(uniqueRestaurants)}</div>
                    <div class="stat-label">Ë®™ÂïèÂ∫óËàóÊï∞</div>
                </div>
            `;
        }

        // Ë®òÈå≤„Éï„Ç£„É´„Çø„Éº„ÉªË°®Á§∫
        function filterAndDisplayRecords() {
            let records = getRecords();
            
            // ÂãïÁâ©„Éï„Ç£„É´„Çø„Éº
            const animalFilter = document.getElementById('animalFilter').value;
            if (animalFilter) {
                records = records.filter(record => {
                    const part = getPartById(record.partId);
                    return part && part.animalType === animalFilter;
                });
            }
            
            // ÊúüÈñì„Éï„Ç£„É´„Çø„Éº
            const periodFilter = document.getElementById('periodFilter').value;
            if (periodFilter) {
                const now = new Date();
                let startDate;
                
                switch (periodFilter) {
                    case 'today':
                        startDate = new Date(now.toDateString());
                        break;
                    case 'week':
                        startDate = new Date(now);
                        startDate.setDate(now.getDate() - 7);
                        break;
                    case 'month':
                        startDate = new Date(now.getFullYear(), now.getMonth(), 1);
                        break;
                    case 'year':
                        startDate = new Date(now.getFullYear(), 0, 1);
                        break;
                }
                
                if (startDate) {
                    records = records.filter(record => new Date(record.date) >= startDate);
                }
            }
            
            // Ê∫ÄË∂≥Â∫¶„Éï„Ç£„É´„Çø„Éº
            const ratingFilter = document.getElementById('ratingFilter').value;
            if (ratingFilter) {
                const minRating = parseInt(ratingFilter);
                records = records.filter(record => record.rating >= minRating);
            }
            
            // „Ç≠„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢
            const keyword = document.getElementById('searchKeyword').value.toLowerCase().trim();
            if (keyword) {
                records = records.filter(record => {
                    const part = getPartById(record.partId);
                    const partName = part ? (part.name + part.nameKana).toLowerCase() : '';
                    const memo = (record.memo || '').toLowerCase();
                    const restaurant = (record.restaurant || '').toLowerCase();
                    
                    return partName.includes(keyword) || 
                           memo.includes(keyword) || 
                           restaurant.includes(keyword);
                });
            }
            
            // „ÇΩ„Éº„Éà
            const sortOrder = document.getElementById('sortOrder').value;
            records.sort((a, b) => {
                switch (sortOrder) {
                    case 'date_asc':
                        return new Date(a.date) - new Date(b.date);
                    case 'date_desc':
                        return new Date(b.date) - new Date(a.date);
                    case 'rating_asc':
                        return a.rating - b.rating;
                    case 'rating_desc':
                        return b.rating - a.rating;
                    default:
                        return new Date(b.date) - new Date(a.date);
                }
            });
            
            filteredRecords = records;
            displayRecords(records);
        }

        // Ë®òÈå≤Ë°®Á§∫
        function displayRecords(records) {
            const container = document.getElementById('recordsList');
            const noRecordsDiv = document.getElementById('noRecords');
            
            if (records.length === 0) {
                container.style.display = 'none';
                noRecordsDiv.style.display = 'block';
                return;
            }
            
            container.style.display = 'block';
            noRecordsDiv.style.display = 'none';
            
            container.innerHTML = records.map(record => {
                const part = getPartById(record.partId);
                if (!part) return '';
                
                const animalInfo = getAnimalInfo(part.animalType);
                const rarityInfo = getRarityInfo(part.rarity);
                
                return `
                    <div class="record-item" style="
                        padding: 20px; 
                        border-bottom: 1px solid #eee; 
                        cursor: pointer;
                        transition: background-color 0.3s ease;
                    " onclick="showRecordDetail('${record.id}')" 
                       onmouseover="this.style.backgroundColor='#f8f9fa'" 
                       onmouseout="this.style.backgroundColor='white'">
                        <div style="display: flex; justify-content: space-between; align-items: start; gap: 15px;">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                    <span style="font-size: 1.5em;">${animalInfo.icon}</span>
                                    <span style="font-size: 1.2em; font-weight: bold;">${part.name}</span>
                                    <span style="color: ${rarityInfo.color}; font-size: 0.9em;">
                                        ${getRarityStars(part.rarity)}
                                    </span>
                                </div>
                                <div style="color: #666; margin-bottom: 8px;">
                                    ${part.nameKana} (${animalInfo.name})
                                </div>
                                ${record.memo ? 
                                    `<div style="color: #333; margin-bottom: 8px; line-height: 1.4;">
                                        ${record.memo.length > 100 ? record.memo.substring(0, 100) + '...' : record.memo}
                                    </div>` : ''
                                }
                                ${record.restaurant ? 
                                    `<div style="color: #666; font-size: 0.9em;">
                                        üìç ${record.restaurant}
                                    </div>` : ''
                                }
                            </div>
                            <div style="text-align: right; color: #666;">
                                <div style="margin-bottom: 5px;">
                                    ${formatDate(record.date)}
                                </div>
                                <div style="color: #ffd700; font-size: 1.1em;">
                                    ${'‚≠ê'.repeat(record.rating)}
                                </div>
                                <div style="font-size: 0.8em; margin-top: 5px;">
                                    ${getRelativeDate(record.date)}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Ë®òÈå≤Ë©≥Á¥∞Ë°®Á§∫
        function showRecordDetail(recordId) {
            const record = getRecords().find(r => r.id === recordId);
            if (!record) return;
            
            const part = getPartById(record.partId);
            if (!part) return;
            
            const animalInfo = getAnimalInfo(part.animalType);
            const rarityInfo = getRarityInfo(part.rarity);
            
            document.getElementById('recordDetailBody').innerHTML = `
                <div style="text-align: center; margin-bottom: 25px;">
                    <div style="font-size: 3em; margin-bottom: 10px;">${animalInfo.icon}</div>
                    <h3 style="margin-bottom: 5px;">${part.name}</h3>
                    <div style="color: #666; margin-bottom: 10px;">${part.nameKana}</div>
                    <div style="color: ${rarityInfo.color}; font-weight: bold;">
                        ${getRarityStars(part.rarity)} ${rarityInfo.label}
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px;">üìÖ È£ü„Åπ„ÅüÊó•</h4>
                    <p>${formatDate(record.date)} (${getRelativeDate(record.date)})</p>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px;">‚≠ê Ê∫ÄË∂≥Â∫¶</h4>
                    <div style="font-size: 1.2em; color: #ffd700;">
                        ${'‚≠ê'.repeat(record.rating)} (${record.rating}/5)
                    </div>
                </div>
                
                ${record.memo ? `
                    <div style="margin-bottom: 20px;">
                        <h4 style="margin-bottom: 10px;">üìù „É°„É¢„ÉªÊÑüÊÉ≥</h4>
                        <p style="line-height: 1.6; background: #f8f9fa; padding: 15px; border-radius: 8px;">
                            ${record.memo}
                        </p>
                    </div>
                ` : ''}
                
                ${record.restaurant ? `
                    <div style="margin-bottom: 20px;">
                        <h4 style="margin-bottom: 10px;">üè™ „ÅäÂ∫ó</h4>
                        <p>${record.restaurant}</p>
                    </div>
                ` : ''}
                
                <div style="margin-bottom: 25px;">
                    <h4 style="margin-bottom: 10px;">üçñ ÈÉ®‰Ωç„Å´„Å§„ÅÑ„Å¶</h4>
                    <p style="color: #666; line-height: 1.6;">${part.description}</p>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-primary" style="flex: 1;" onclick="editRecord('${record.id}')">
                        Á∑®ÈõÜ
                    </button>
                    <button class="btn btn-outline" onclick="closeRecordDetailModal()">
                        Èñâ„Åò„Çã
                    </button>
                </div>
            `;
            
            document.getElementById('recordDetailModal').classList.add('active');
        }

        // Ë®òÈå≤Á∑®ÈõÜ
        function editRecord(recordId) {
            const record = getRecords().find(r => r.id === recordId);
            if (!record) return;
            
            const part = getPartById(record.partId);
            if (!part) return;
            
            currentEditingRecordId = recordId;
            
            const animalInfo = getAnimalInfo(part.animalType);
            const rarityInfo = getRarityInfo(part.rarity);
            
            // ÈÉ®‰ΩçÊÉÖÂ†±Ë°®Á§∫
            document.getElementById('editPartInfo').innerHTML = `
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div style="font-size: 2em;">${animalInfo.icon}</div>
                    <div>
                        <div style="font-size: 1.2em; font-weight: bold;">${part.name}</div>
                        <div style="color: #666;">${part.nameKana}</div>
                        <div style="color: ${rarityInfo.color}; font-size: 0.9em;">
                            ${getRarityStars(part.rarity)} ${rarityInfo.label}
                        </div>
                    </div>
                </div>
            `;
            
            // „Éï„Ç©„Éº„É†ÂÄ§Ë®≠ÂÆö
            document.getElementById('editEatenDate').value = record.date;
            document.getElementById('editMemo').value = record.memo || '';
            document.getElementById('editRatingValue').value = record.rating;
            document.getElementById('editRestaurant').value = record.restaurant || '';
            
            // ÊòüË©ï‰æ°Ë°®Á§∫Êõ¥Êñ∞
            updateEditStarDisplay(record.rating);
            
            // „É¢„Éº„ÉÄ„É´Ë°®Á§∫
            closeRecordDetailModal();
            document.getElementById('editRecordModal').classList.add('active');
        }

        // Á∑®ÈõÜÁî®ÊòüË©ï‰æ°Ë®≠ÂÆö
        function setupEditRatingStars() {
            const stars = document.querySelectorAll('#editRatingStars .star');
            const ratingInput = document.getElementById('editRatingValue');
            
            stars.forEach((star, index) => {
                star.style.cursor = 'pointer';
                star.style.fontSize = '1.5em';
                star.style.margin = '0 2px';
                
                star.addEventListener('click', () => {
                    const rating = parseInt(star.dataset.rating);
                    ratingInput.value = rating;
                    updateEditStarDisplay(rating);
                });
                
                star.addEventListener('mouseover', () => {
                    const rating = parseInt(star.dataset.rating);
                    updateEditStarDisplay(rating);
                });
            });
            
            document.getElementById('editRatingStars').addEventListener('mouseleave', () => {
                const currentRating = parseInt(ratingInput.value);
                updateEditStarDisplay(currentRating);
            });
        }

        // Á∑®ÈõÜÊòüË°®Á§∫Êõ¥Êñ∞
        function updateEditStarDisplay(rating) {
            const stars = document.querySelectorAll('#editRatingStars .star');
            stars.forEach((star, index) => {
                star.style.opacity = index < rating ? '1' : '0.3';
            });
        }

        // Á∑®ÈõÜ„Éï„Ç©„Éº„É†ÈÄÅ‰ø°
        function handleEditSubmit(e) {
            e.preventDefault();
            
            if (!currentEditingRecordId) return;
            
            const updates = {
                date: document.getElementById('editEatenDate').value,
                memo: document.getElementById('editMemo').value,
                rating: parseInt(document.getElementById('editRatingValue').value),
                restaurant: document.getElementById('editRestaurant').value
            };
            
            if (updateRecord(currentEditingRecordId, updates)) {
                closeEditRecordModal();
                filterAndDisplayRecords();
                updateHistorySummary();
                alert('Ë®òÈå≤„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„ÅüÔºÅ');
            } else {
                alert('Ë®òÈå≤„ÅÆÊõ¥Êñ∞„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ');
            }
        }

        // Ë®òÈå≤ÂâäÈô§
        function deleteCurrentRecord() {
            if (!currentEditingRecordId) return;
            
            if (confirm('„Åì„ÅÆË®òÈå≤„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ')) {
                if (deleteRecord(currentEditingRecordId)) {
                    closeEditRecordModal();
                    filterAndDisplayRecords();
                    updateHistorySummary();
                    alert('Ë®òÈå≤„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü„ÄÇ');
                } else {
                    alert('Ë®òÈå≤„ÅÆÂâäÈô§„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ');
                }
            }
        }

        // „É¢„Éº„ÉÄ„É´Èñ¢ÈÄ£
        function closeRecordDetailModal() {
            document.getElementById('recordDetailModal').classList.remove('active');
        }

        function closeEditRecordModal() {
            document.getElementById('editRecordModal').classList.remove('active');
            currentEditingRecordId = null;
        }

        // „Éá„Éê„Ç¶„É≥„ÇπÈñ¢Êï∞
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
    </script>
</body>
</html>